\<Taberna Noctis\> \-- (夜之小酒馆)

**游戏简介:**

《Taberna
Noctis》是一款单人开发的横板扁平风模拟经营 × 料理卡牌游戏。画面以简洁色块、俐落线条与柔和渐变构成，呈现出现代感十足的深夜酒馆.

在游戏中, 白天你需要在酒馆中进行进货,备货, 准备好一切晚上经营的所有需要,
然后可以研发菜单, 丰富自己店内酒饮的种类,
通过不同材料的混搭获得不同的效果,
然后从中挑选出最适合当天晚上顾客喜欢的类型上架菜单进行销售

![白天](./media/0_0_白天.png)
在游戏中, 晚上你则是一位资深的调酒师,
根据白天研发的酒饮种类总含有的不同效果,不同数值,
为不同状态的顾客提供相应的酒饮满足他们的心情需求,
当顾客满意后将会为你的酒馆增加评价分数.
当在一定时间内达到一定的分数即可获得评选星级酒馆,
并获得一定的资金奖励和特殊酒饮配方

![晚上](./media/0_1_晚上.png)

**灵感来源:**

| ![Point1](./media/0_2_Point1.png)<br/>_灵感点 1_ | ![Point2](./media/0_3_Point2.png)<br/>_灵感点 2_ | ![Point3](./media/0_4_Point3.png)<br/>_灵感点 3_ |     |
| :----------------------------------------------: | :----------------------------------------------: | :----------------------------------------------: | :-: |

组合式灵感来源

1.  **深夜治愈系叙事**

《深夜食堂》×《Midnight Diner》

------以"一杯酒一个故事"的单元剧结构，为每位顾客留下微小却深刻的人生切片。

2.  **极简横板经营节奏**

《Mini Metro》×《Good Pizza, Great Pizza》

------横向空间一眼看完，进货---备货---上架---服务的循环在一条时间轴内完成，零学习成本。

3.  **卡牌式调酒策略**

《Slice & Dice》×《Coffee Talk》

------把"配方"抽象成卡牌数值（甜度、酒精度、风味标签），顾客状态=敌人
Buff，调酒=出牌解谜。

4.  **现代扁平视觉符号**

Dropbox 2018 品牌插画系统

------限定 16
色以内、禁用渐变与投影，直接给出了如何在不失温度的情况下保持极简配色的方法论。

**故事背景:**

在霓虹从不熄灭的未来都市"新宵京"，由于高压力的生活社会环境，人们的生活压力极大。你受不了在公司中漫无天日的工作，受老板和上司的欺压决定辞职学习一些技术成为了一位调酒师并接手一家专为打工人开放的小酒馆，为顾客提供能够缓解生活压力的酒饮。酒馆位于一条安静的街道，　很多时候都像是每一个疲惫的打工人一个温暖的港湾，为他们提供减轻压力的小小帮助。

这家酒馆位于一处不算偏僻的街道，店外面的灯牌与一张写着「Taberna
Noctis」的金属铭牌，却能在夜里把整条街染成低饱和的靛青。人们说，那颜色像凌晨四点的系统更新条，缓慢却笃定地把"崩溃"覆盖成"重启"

条例规定：

• 营业时间 23:00--05:00；

• 顾客从店外面走到吧台，向你描述自己的心情状况；

• 需要根据自己的现有的材料为顾客量心打造一款酒饮减少他的压力；

在吧台中你摆放了一系列的制作材料、一本小小配方小册和一份简单的菜单，菜单上有根据上一任老板写下的一些酒饮的名字，你可以根据现有的材料制作出顾客心意的酒饮。

顾客弹出对话框描述今天的心情，然后调酒师需要根据心情调配酒品。

你根据排列组合把对应材料划入摇壶------

蓝色 = 压力／抑郁，粉色 = 疲惫，青色 = 焦虑，红色＝急躁

摇出的鸡尾酒就正好能够对应顾客的心情，等顾客喝完后她的心情会变得好受些，　然后留下费用离开，并给出一个评价分数。

每天的白天则是店休日，每次晚上开店时，你都会用刮刀把前一天的酒饮菜单刮去，写出根据当天进货时材料得到的酒饮，像给城市的零部件更换当天到货的新润滑剂。

每天白天，你会选择在起床后就进入后厨进行进货，采购今天晚上需要的材料；有时你会看看新闻了解今天发生了什么。然后根据今天的情况调整进货的材料，并根据小配方册选出适合今天心情状态的饮品。

每卖出一杯酒，进度条就向前推进。你从不解释进度条的真实长度，

只在每次打烊后，把最后一滴酒倒进水槽。

水流冲走残渣，也冲走城市 0.01% 的崩溃。

然后你把窗擦净，像把代码回滚到零，

等待下一位顾客，用不同的饮品重新编译人们的夜晚。

**游戏玩法：**

白天：

玩家会进入后方的厨房开始清点材料同时出现一个进货界面，根据你拥有的金钱以及看到的一些新闻信息来决定需要购买什么样的材料，购买材料后可以选择研发饮品，通过添加三样不同的材料制作出饮品。饮品的效果将会由添加材料的先后顺序，添加的份量来决定饮品中对应材料的不同效果

夜晚：

夜晚酒馆开始营业，调酒师需要等待顾客的到来。当顾客出现在界面时，会显示他现在的状态＜忙碌的＞＜急躁的＞＜烦闷的＞＜挑剔的＞＜友好的＞。　调酒师需要根据你的配方挑选出最适合他们的饮品。因为每种饮品的材料间的差异化导致每种饮品的效果不同，顾客则会根据自己恢复的心情值来给出金钱------饮品费用+小费（小费就是根据当前增加的心情值（心情增量"ΔM 可正可负）\*一个倍率增加），如果时降低心情值则不好减少总的金额。

**用例图（Use Case）**

![Use Case](./media/IMG_UseCase.png)

**卡牌交互时序图（Sequence）**

![Card Interaction Sequence](./media/IMG_Sequence.png)

**夜晚出杯状态机（State Machine）**

![Serve State Machine](./media/IMG_State.png)

**一天流程：**

- 开始新的一天：查看昨夜结算（资金、评价、解锁配方）→ 浏览今日新闻/提示，获取顾客偏好线索；
- 白天（进货与研发）：清点库存与资金 → 打开进货界面采购材料 → 选择三种材料并设定顺序/份量进行研发 → 形成候选菜单并筛选出今晚的上架饮品；
- 夜晚（营业 180 秒）：顾客每 25~35 秒到店，展示状态与身份倍率 → 依据配方或临时组合调酒出杯，提高顾客心情 → 结算付费并推进进度条；
- 打烊：汇总当晚收益、评价与解锁内容 → 刮除旧菜单，为次日重新上架做准备，存档。

```mermaid
sequenceDiagram
    participant P as 玩家/调酒师
    participant Info as 新闻/提示
    participant Stock as 进货界面
    participant Lab as 研发/菜单
    participant Guest as 顾客
    participant Bar as 吧台/出杯
    participant Score as 评分/结算

    P->>Info: 查看当日线索
    P->>Stock: 清点库存与资金，采购材料
    Stock-->>P: 材料入库
    P->>Lab: 组合三材料（顺序/份量）
    Lab-->>P: 预估 ΔM/成本
    P->>Lab: 形成并上架今晚上线菜单
    Note over P,Lab: 白天准备结束，进入营业

    loop 180 秒营业
        Guest-->>P: 到店并展示状态/身份
        P->>Bar: 选择菜单或临时配方
        Bar-->>Guest: 出杯（提升心情）
        Guest-->>Score: 支付 30 + max(0, ΔM×1.2×身份倍率)
        Score-->>P: 收益与进度条推进
    end

    P->>Score: 打烊结算（资金、评价、解锁）
    P-->>P: 刮除旧菜单，准备次日
```

**数值设计：**

通用常量

• 初始金钱：500

• 单局营业时长（夜晚）：180 秒（现实 3 分钟）

• 顾客生成间隔：25\~35 秒随机

• 顾客基础付费：30 （小费）

• 小费倍率：1.2（心情增量 ≥1 时触发，向下取整）

**NPC 到访概率设计（25 组合方案）**

- **基础模型**：5 种身份（公司职员、小领导、自由职业者、老板、大学生）× 5 种状态（忙碌、急躁、烦闷、挑剔、友好）= 25 种组合
- **基础概率**：每种组合的基础概率均等，各占 4%（100% ÷ 25 = 4%）
- **每日消息调整**：
  - 每日事件对特定"身份 × 状态"组合进行调整，调整值 Δ 范围为 -15% ~ +15%
  - 调整后的原始概率 = 基础概率 4% + Δ
- **截断保护**：
  - 最小值截断：任何组合概率不得低于 0.5%（防止出现 0 概率）
  - 最大值截断：任何组合概率不得高于 30%（防止单一组合过度集中）
  - 计算公式：截断后概率 = clamp(4% + Δ, 0.5%, 30%)
- **归一化处理**：
  - 将所有 25 个组合的截断后概率求和（记为 S）
  - 每个组合的归一化概率 = (截断后概率 ÷ S) × 100%
  - 保证最终所有组合概率之和恒为 100%
- **性别分配**：
  - 每个"身份 × 状态"组合的归一化概率再按性别均分（男性 50%，女性 50%）
  - 最终每个"身份 × 状态 × 性别"的概率 = 归一化概率 ÷ 2
  - 最终形成 50 条概率数据（25 组合 × 2 性别）
- **计算时机**：每个游戏日开始时，根据当日消息自动计算一次完整概率分布

**每日消息数值设计**

每日消息系统会在每个游戏日开始时随机选择一条新闻事件，影响当天顾客的到访分布。

- **消息池规模**：建议配置 8 条不同的每日消息（可扩展至更多）
- **随机机制**：每天从消息池中随机抽取一条，系统通过基于天数的混合算法确保每天抽取不同消息，避免连续重复
- **调整机制**：每条消息包含 2~4 个调整项，每个调整项可针对特定身份、状态、性别或 NPC 进行到访概率调整
- **调整幅度**：
  - 常规事件：单项调整控制在 -15% ~ +15% 之间
- **平衡原则**：
  - 消息池中正向调整（增加到访）与负向调整（减少到访）的数量应大致平衡
  - 确保不同身份、状态的 NPC 都能在不同消息中受到影响
  - 最终到访概率通过截断（0.5%~30%）和归一化（总和 100%）自动平衡
- **示例**（基于 4% 基础概率）：
  - "城市酒水税上涨"：公司职员 × 忙碌组合调整 -3%（4%→1%），老板 × 友好组合调整 +5%（4%→9%），归一化后实际概率会略有浮动
  - "新型酒谱流行"：所有身份在友好状态下调整 +8%（4%→12%），其他状态保持 4%
  - "加班文化盛行"：公司职员 × 忙碌调整 +10%（4%→14%），公司职员 × 急躁调整 +8%（4%→12%），公司职员 × 友好调整 -6%（4%→0%，截断后 0.5%）

初始心情值表格

---

    状态／身份     公司职员    小领导     自由职业者    老板    大学生

    ＜忙碌的＞        3           4           5            6         6

    ＜急躁的＞        2           3           4            5         5

    ＜烦闷的＞        4           3           3            4         4

    ＜挑剔的＞        4           5           4            6         3

    ＜友好的＞        7           8           8            8         9

---

16 种材料以及 9 种鸡尾酒的数值设计

酒类及材料信息表

---

**序号** **材料中文名** **忙碌** **急躁** **烦闷** **挑剔** **友好** **单价**

      1            金酒            0          -1         0          +2         +1         25

      2           伏特加           -1         -1         +1         0          0          20

      3           白朗姆           -1         0          0          -1         +2         22

      4           龙舌兰           -1         -2         -1         +1         0          24

      5         波本威士忌         +2         0          -1         -1         +1         30

      6         黑麦威士忌         +2         -1         0          +1         0          32

      7          干味美思          0          0          -1         +2         0          18

      8          甜味美思          0          +1         0          +2         +1         18

      9         橙皮利口酒         0          -1         0          +1         +2         15

      10          金巴利           0          +2         -1         +2         -1         20

      11       安高天娜苦精        +1         +1         -1         +1         0          5

      12          单糖浆           -1         +1         +1         0          +1         3

      13           青柠            -2         -1         +1         +1         0          4

      14           柠檬            -2         -1         0          0          +1         4

      15          苏打水           -2         +1         +2         0          +1         2

      16           可乐            -1         +1         +2         -1         +2         3

---

鸡尾酒信息表

---

        **鸡尾酒名**         **忙碌**   **急躁**   **烦闷**   **挑剔**   **友好**   **成本**   **售价**   **评价**

       Martini 马天尼           +1         -2         -2         +4         +1         48         72         +5

      Manhattan 曼哈顿          +3         0          -1         +4         +1         55         82         +4

     Old Fashioned 古典         +2         +2         -1         0          +2         38         57         +3

     Margarita 玛格丽特         -4         -4         0          +3         +2         46         69         +3

       Daiquiri 戴基里          -4         -2         +1         +1         +3         29         43         +2

Moscow Mule 莫斯科骡子 -5 -1 +3 +1 +1 31 46 +2

      Negroni 尼格罗尼          +1         +3         -2         +5         0          63         94         +5

     Cuba Libre 自由古巴        -4         +1         +2         -2         +4         32         48         +2
     Unspeakable 不可描述之物    -5         -5         -5         -5         -5         120        1          -10

---

身份倍率：

公司职员 1.0 / 小领导 1.2 / 自由职业者 1.1 / 老板 1.5 / 大学生 0.9

饮品效果计算公式

- 计算每材料"S ｅｑｕｅｎｃｅ值" = 强度 × 顺序权重

- 汇总三种材料的同类方向值，得到最终"心情增量"ΔM（可正可负）

- 结算

  顾客最终心情 = 初始心情 + ΔM

  付费 = 饮品价格（假设 4 ０） + max(0, ΔM × 小费倍率 × 身份倍率)

**双系统机制（心情 + 评价）**

游戏采用**心情系统**和**评价系统**双轨并行：

1. **心情系统**（即时收益）：

   - 材料组合影响顾客心情 → 心情增量 ΔM → 影响小费
   - 作用：决定当次顾客的付费金额
   - 计算：小费 = max(0, ΔM × 1.2 × 身份倍率)

2. **评价系统**（长期发展）：
   - 每款鸡尾酒有固定评价变化值（见上表"评价"列）
   - 作用：累计到酒馆总评价值，影响星级和顾客质量
   - 计算：新评价值 = 当前评价值 + 鸡尾酒评价变化

两个系统**同时生效、互不干扰**：

- 高心情增量（ΔM 大）→ 多赚小费（短期利益）
- 高评价鸡尾酒 → 提升酒馆星级（长期发展）
- 玩家需平衡：用高评价经典酒（Martini +5）提升星级，还是用高利润酒快速赚钱

**ER 图（数据模型）**

![ER Diagram](./media/IMG_ER.png)

**美术设计：**

## 材料设计

|          ![金酒](./材料设计/0_GIN金酒.png)<br/>_金酒 (GIN)_          |        ![伏特加](./材料设计/1_VODKA伏特加.png)<br/>_伏特加 (VODKA)_        |          ![龙舌兰](./材料设计/2_TEQUILA龙舌兰.png)<br/>_龙舌兰 (TEQUILA)_          | ![波本威士忌](./材料设计/3_BOURBON波本威士忌.png)<br/>_波本威士忌 (BOURBON)_ |
| :------------------------------------------------------------------: | :------------------------------------------------------------------------: | :--------------------------------------------------------------------------------: | :--------------------------------------------------------------------------: |
| ![黑麦威士忌](./材料设计/4_RYE黑麦威士忌.png)<br/>_黑麦威士忌 (RYE)_ | ![橙皮利口酒](./材料设计/5_CITRUS橙皮利口酒.png)<br/>_橙皮利口酒 (CITRUS)_ | ![安高天娜苦精](./材料设计/6_BITTERS安高天娜苦精.png)<br/>_安高天娜苦精 (BITTERS)_ |       ![金巴利](./材料设计/7_CAMPARI金巴利.png)<br/>_金巴利 (CAMPARI)_       |
|    ![干味美思](./材料设计/8_DRY干味美思.png)<br/>_干味美思 (DRY)_    |     ![甜味美思](./材料设计/9_SWEET甜味美思.png)<br/>_甜味美思 (SWEET)_     |                  ![单糖浆](./材料设计/10_单糖浆.png)<br/>_单糖浆_                  |                  ![青柠](./材料设计/11_青柠.png)<br/>_青柠_                  |
|              ![柠檬](./材料设计/12_柠檬.png)<br/>_柠檬_              |        ![苏打水](./材料设计/13_SODA苏打水.png)<br/>_苏打水 (SODA)_         |                                                                                    |                                                                              |

## 鸡尾酒设计

|             ![马天尼](./鸡尾酒设计/1_马天尼.png)<br/>_马天尼 (Martini)_              | ![玛格丽特](./鸡尾酒设计/2_玛格丽特.png)<br/>_玛格丽特 (Margarita)_ |        ![曼哈顿](./鸡尾酒设计/3_曼哈顿.png)<br/>_曼哈顿 (Manhattan)_        |     ![戴基里](./鸡尾酒设计/4_戴基里.png)<br/>_戴基里 (Daiquiri)_     |
| :----------------------------------------------------------------------------------: | :-----------------------------------------------------------------: | :-------------------------------------------------------------------------: | :------------------------------------------------------------------: |
|             ![古典](./鸡尾酒设计/5_古典.png)<br/>_古典 (Old Fashioned)_              |  ![尼格罗尼](./鸡尾酒设计/6_尼格罗尼.png)<br/>_尼格罗尼 (Negroni)_  | ![莫斯科骡子](./鸡尾酒设计/7_莫斯科骡子.png)<br/>_莫斯科骡子 (Moscow Mule)_ | ![自由古巴](./鸡尾酒设计/8_自由古巴.png)<br/>_自由古巴 (Cuba Libre)_ |
| ![不可描述之物](./鸡尾酒设计/9_不可描述之物.png)<br/>_不可描述之物 (特制神秘鸡尾酒)_ |                                                                     |                                                                             |                                                                      |
